!function(){"use strict";const e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-btn",inactiveButtonClass:"popup__submit-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},t={},s=(document.getElementById("add-form"),document.getElementById("edit-form")),n=document.querySelector(".profile__edit-btn"),i=document.querySelector(".profile__add-btn"),r=document.querySelector(".popup__photo"),o=document.querySelector(".popup__photoTitle");class l{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._settings.inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._settings.inactiveButtonClass))}_setInputEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setInputEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class a{constructor(e,t){let{data:s,handleCardClick:n}=e;var i,r;r=()=>{this._likeBtn.classList.toggle("card__like-btn_active")},(i="_handleLikeCard")in this?Object.defineProperty(this,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[i]=r,this._title=s.title,this._link=s.link,this._cardSelector=t,this._handleCardClick=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._cardPhoto=this._element.querySelector(".card__photo-container");const e=this._element.querySelector(".card__title");return this._cardPhoto.style.backgroundImage="url(".concat(this._link,")"),this._cardPhoto.ariaLabel=this._title,e.textContent=this._title,this._setEventListeners(),this._element}_handleDeleteCard(){this._element.remove(),this._element=null,this._cardPhoto=null}_setEventListeners(){this._deleteBtn=this._element.querySelector(".card__delete-btn"),this._likeBtn=this._element.querySelector(".card__like-btn"),this._deleteBtn.addEventListener("click",(e=>{e.stopPropagation(),this._handleDeleteCard()})),this._likeBtn.addEventListener("click",this._handleLikeCard),this._cardPhoto.addEventListener("click",(()=>{this._handleCardClick({title:this._title,link:this._link})}))}}class c{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup__active"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup__active"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup__active")&&this.close(),e.target.classList.contains("popup__close-btn")&&this.close()}))}}class d extends c{constructor(e,t){super(t),this._link=e.link,this._title=e.title}open(){r.src=this._link,r.alt=this._title,o.textContent=this._title,super.open()}}class _ extends c{constructor(t,s){super(t),this._handleFormSubmit=s,this._formElement=this._popup.querySelector(e.formSelector)}_getInputValues(){const t=Array.from(this._popup.querySelectorAll(e.inputSelector)),s={};return t.forEach((e=>{s[e.name]=e.value})),s}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues()),this._formElement.reset()}))}close(){super.close(),this._formElement.reset()}}const h=e=>{const t=new a({data:e,handleCardClick:e=>{const t=new d(e,"#photo-viewer-popup");t.open(),t.setEventListeners()}},"#card-template");p.addItem(t.generateCard())},u=new class{constructor(e){let{selectors:t}=e;this._nameElement=document.querySelector(t.name),this._descriptionElement=document.querySelector(t.description)}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.description=this._descriptionElement.textContent,e}setUserInfo(e){this._nameElement.textContent=e.name,this._descriptionElement.textContent=e.description}}({selectors:{name:".profile__name-title",description:".profile__description"}}),p=new class{constructor(e,t){let{items:s,renderer:n}=e;this._initialArray=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._initialArray.forEach((e=>{this._renderer(e)}))}}({items:[{title:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{title:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{title:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{title:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{title:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{title:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:h},".gallery__list"),m=new _("#add-popup",(e=>{h(e),m.close()})),E=new _("#edit-popup",(e=>{u.setUserInfo(e),E.close()}));var v;n.addEventListener("click",(function(){const{name:e,description:n}=u.getUserInfo();s.name.value=e,s.description.value=n,t["edit-form"].resetValidation(),E.open()})),i.addEventListener("click",(function(){t["add-form"].resetValidation(),m.open()})),v=e,Array.from(document.querySelectorAll(v.formSelector)).forEach((e=>{const s=new l(v,e);t[e.getAttribute("name")]=s,s.enableValidation()})),m.setEventListeners(),E.setEventListeners(),p.renderItems()}();